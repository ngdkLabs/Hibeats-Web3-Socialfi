specVersion: 0.0.5
schema:
  file: ./schema.graphql
dataSources:
  # SocialGraph disabled - using Datastream (EAS) for social features
  # All social interactions (posts, likes, comments, follows) are handled by Datastream
  # This subgraph only indexes NFT and trading data
  
  - kind: ethereum
    name: UserProfile
    network: somnia-testnet
    source:
      address: "0x6aD6eBc95116A81CB89FCB2676E829b5dabF7536"
      abi: UserProfile
      startBlock: 231334285
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - UserProfile
      abis:
        - name: UserProfile
          file: ./abis/UserProfile.json
      eventHandlers:
        - event: ProfileCreated(indexed address,indexed uint256,string)
          handler: handleProfileCreated
        - event: ProfileUpdated(indexed address)
          handler: handleProfileUpdated
        - event: ArtistVerified(indexed address,uint256)
          handler: handleArtistVerified
        - event: ArtistUpgraded(indexed address,uint256)
          handler: handleArtistUpgraded
        - event: VerificationRenewed(indexed address,uint256,uint256)
          handler: handleVerificationRenewed
        - event: VerificationExpired(indexed address)
          handler: handleVerificationExpired
        - event: UsernameChanged(indexed address,string,string)
          handler: handleUsernameChanged
      file: ./src/user-profile.ts
  - kind: ethereum
    name: PlaylistManager
    network: somnia-testnet
    source:
      address: "0x912D6898AD5F9351d3AC86F960279a34a5fD582B"
      abi: PlaylistManager
      startBlock: 231334285
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Playlist
        - PlaylistSong
        - GlobalStats
      abis:
        - name: PlaylistManager
          file: ./abis/PlaylistManager.json
      eventHandlers:
        - event: PlaylistCreated(indexed uint256,indexed address,string)
          handler: handlePlaylistCreated
        - event: PlaylistUpdated(indexed uint256)
          handler: handlePlaylistUpdated
        - event: SongAddedToPlaylist(indexed uint256,indexed uint256)
          handler: handleSongAddedToPlaylist
        - event: SongRemovedFromPlaylist(indexed uint256,indexed uint256)
          handler: handleSongRemovedFromPlaylist
      file: ./src/playlist-manager.ts
  # DirectMessages disabled - not currently used
  # - kind: ethereum
  #   name: DirectMessages
  #   network: somnia-testnet
  #   source:
  #     address: "0x4deE5202e34f7AA84504Dd70446d9A25a7921a6E"
  #     abi: DirectMessages
  #     startBlock: 231334285
  - kind: ethereum
    name: SongNFT
    network: somnia-testnet
    source:
      address: "0xc9Ab73b5f988826943e4f63E89ed0841757CBD6c"
      abi: SongNFT
      startBlock: 231334285
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Song
        - SongTransfer
        - GlobalStats
      abis:
        - name: SongNFT
          file: ./abis/SongNFT.json
      eventHandlers:
        - event: SongMinted(indexed uint256,indexed address,string,string)
          handler: handleSongMinted
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleTransfer
      file: ./src/song-nft.ts
  - kind: ethereum
    name: Marketplace
    network: somnia-testnet
    source:
      address: "0xe62Dc8113C77bDA6b13Eebb86f3453C4df5399e2"
      abi: Marketplace
      startBlock: 231334285
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - SongListing
        - SongSale
        - MarketplaceStats
        - GlobalStats
      abis:
        - name: Marketplace
          file: ./abis/Marketplace.json
      eventHandlers:
        - event: ListingCreated(indexed uint256,indexed address,indexed address,uint256,uint256)
          handler: handleListingCreated
        - event: ListingSold(indexed uint256,indexed address,uint256)
          handler: handleListingSold
        - event: ListingCancelled(indexed uint256)
          handler: handleListingCancelled
      file: ./src/marketplace.ts
  - kind: ethereum
    name: TippingSystem
    network: somnia-testnet
    source:
      address: "0xD6CAA4722083afFdBE54949E39C46C164ad1a370"
      abi: TippingSystem
      startBlock: 231334285
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Tip
        - TippingStats
        - GlobalStats
      abis:
        - name: TippingSystem
          file: ./abis/TippingSystem.json
      eventHandlers:
        - event: TipSent(indexed uint256,indexed address,indexed address,uint256,address,uint256)
          handler: handleTipSent
      file: ./src/tipping-system.ts
  - kind: ethereum
    name: AlbumManager
    network: somnia-testnet
    source:
      address: "0x94892b8E7CC63E0C5E5eE7ce27D4E7588CbAf864"
      abi: AlbumManager
      startBlock: 231334285
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Album
        - AlbumSong
        - GlobalStats
      abis:
        - name: AlbumManager
          file: ./abis/AlbumManager.json
      eventHandlers:
        - event: AlbumCreated(indexed uint256,indexed address,string,uint8)
          handler: handleAlbumCreated
        - event: SongAddedToAlbum(indexed uint256,indexed uint256)
          handler: handleSongAddedToAlbum
        - event: SongRemovedFromAlbum(indexed uint256,indexed uint256)
          handler: handleSongRemovedFromAlbum
        - event: AlbumPublished(indexed uint256,uint256)
          handler: handleAlbumPublished
      file: ./src/album-manager.ts
